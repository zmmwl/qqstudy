# -*- coding: utf-8 -*-
"""
AIå…¥é—¨é€Ÿæˆæ•™ç¨‹ - é€‚åˆåˆä¸­ç”Ÿå­¦ä¹ 
=====================================
ä½œè€…ï¼šAIæ•™å­¦å›¢é˜Ÿ
ç›®æ ‡ï¼š2å°æ—¶æŒæ¡AIåŸºç¡€æ¦‚å¿µå’Œå®è·µ

è¿™ä¸ªæ•™ç¨‹å°†å¸¦ä½ ä»é›¶å¼€å§‹å­¦ä¹ äººå·¥æ™ºèƒ½ï¼
æ¯ä¸ªç« èŠ‚éƒ½æœ‰è¯¦ç»†çš„è§£é‡Šå’Œå¯ä»¥è¿è¡Œçš„ä»£ç ã€‚
"""

# ============================================
# å‡†å¤‡å·¥ä½œï¼šå®‰è£…å¿…è¦çš„åº“
# ============================================
"""
åœ¨è¿è¡Œæœ¬æ•™ç¨‹å‰ï¼Œè¯·å…ˆå®‰è£…ä»¥ä¸‹åº“ï¼š
pip install scikit-learn numpy pandas matplotlib

å¦‚æœå®‰è£…å¤ªæ…¢ï¼Œå¯ä»¥ä½¿ç”¨å›½å†…é•œåƒï¼š
pip install scikit-learn numpy pandas matplotlib -i https://pypi.tuna.tsinghua.edu.cn/simple
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn import datasets
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
from sklearn.linear_model import LinearRegression
from sklearn.metrics import accuracy_score, mean_squared_error, r2_score

# è®¾ç½®ä¸­æ–‡æ˜¾ç¤ºï¼ˆå…¼å®¹ä¸åŒç³»ç»Ÿï¼‰
try:
    # Windows
    plt.rcParams['font.sans-serif'] = ['SimHei', 'Microsoft YaHei', 'SimSun']
except:
    pass
try:
    # Linux/Mac
    plt.rcParams['font.sans-serif'] = ['WenQuanYi Micro Hei', 'Noto Sans CJK SC', 'DejaVu Sans']
except:
    pass
plt.rcParams['axes.unicode_minus'] = False    # ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·

print("=" * 60)
print("ğŸ‰ æ¬¢è¿æ¥åˆ°AIå…¥é—¨é€Ÿæˆæ•™ç¨‹ï¼")
print("=" * 60)
print()


# ============================================
# ç¬¬1èŠ‚ï¼šä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ
# ============================================
def lesson_1_what_is_ai():
    """
    ç¬¬1èŠ‚ï¼šä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ
    ========================

    å­¦ä¹ ç›®æ ‡ï¼š
    - ç†è§£äººå·¥æ™ºèƒ½çš„åŸºæœ¬æ¦‚å¿µ
    - äº†è§£AIåœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­çš„åº”ç”¨
    - çŸ¥é“AIçš„ä¸»è¦åˆ†ç±»

    ã€ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿã€‘

    æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœç”µè„‘èƒ½åƒäººä¸€æ ·ï¼š
    - çœ‹ç…§ç‰‡è®¤å‡ºä½ çš„æœ‹å‹ â†’ è®¡ç®—æœºè§†è§‰
    - å¬æ‡‚ä½ è¯´çš„è¯ â†’ è¯­éŸ³è¯†åˆ«
    - è¯»æ–‡ç« ç†è§£å†…å®¹ â†’ è‡ªç„¶è¯­è¨€å¤„ç†
    - ä¸‹å›´æ£‹èµ¢è¿‡äººç±» â†’ æ¸¸æˆAI

    è¿™å°±æ˜¯äººå·¥æ™ºèƒ½ï¼ç®€å•è¯´å°±æ˜¯ï¼šè®©æœºå™¨å˜å¾—"èªæ˜"ï¼Œèƒ½åƒäººä¸€æ ·æ€è€ƒå’Œåšäº‹ã€‚

    ã€AIçš„åˆ†ç±»ã€‘

    1. å¼±äººå·¥æ™ºèƒ½ï¼ˆç°åœ¨ï¼‰
       - åªèƒ½åšä¸€ä»¶äº‹ï¼Œä½†åšå¾—å¾ˆå¥½
       - ä¾‹å­ï¼šAlphaGoåªä¼šä¸‹å›´æ£‹ï¼Œä¸ä¼šåšé¥­

    2. å¼ºäººå·¥æ™ºèƒ½ï¼ˆæœªæ¥ï¼‰
       - åƒäººä¸€æ ·ï¼Œä»€ä¹ˆéƒ½èƒ½å­¦
       - ç›®å‰è¿˜æ²¡æœ‰å®ç°

    ã€AIçš„åº”ç”¨ã€‘

    - æ‰‹æœºï¼šäººè„¸è§£é”ã€è¯­éŸ³åŠ©æ‰‹
    - æ¸¸æˆï¼šNPCæ•Œäººã€æ¨èç³»ç»Ÿ
    - åŒ»ç–—ï¼šè¾…åŠ©è¯Šæ–­
    - äº¤é€šï¼šè‡ªåŠ¨é©¾é©¶
    - è´­ç‰©ï¼šå•†å“æ¨è
    """
    print("=" * 60)
    print("ğŸ“š ç¬¬1èŠ‚ï¼šä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ")
    print("=" * 60)
    print()

    # AIåº”ç”¨ç¤ºä¾‹ï¼šç®€å•çš„è§„åˆ™åŒ¹é…
    print("ğŸ¤– è®©æˆ‘ä»¬æ¥ä½“éªŒä¸€ä¸ªç®€å•çš„AIç¨‹åºï¼")
    print("è¿™æ˜¯ä¸€ä¸ª'æ™ºèƒ½é—®ç­”æœºå™¨äºº'ï¼š")
    print()

    # å®šä¹‰é—®é¢˜å’Œç­”æ¡ˆçš„å¯¹åº”å…³ç³»ï¼ˆçŸ¥è¯†åº“ï¼‰
    qa_dict = {
        "ä½ å¥½": "ä½ å¥½ï¼æˆ‘æ˜¯AIå°åŠ©æ‰‹ï¼Œå¾ˆé«˜å…´è®¤è¯†ä½ ï¼",
        "ä½ å«ä»€ä¹ˆ": "æˆ‘æ˜¯AIå…¥é—¨æ•™ç¨‹çš„æ¼”ç¤ºæœºå™¨äºº",
        "ä»€ä¹ˆæ˜¯ai": "AIå°±æ˜¯äººå·¥æ™ºèƒ½ï¼Œè®©æœºå™¨å˜å¾—èªæ˜",
        "ä»Šå¤©å¤©æ°”": "æŠ±æ­‰ï¼Œæˆ‘è¿˜æ²¡æœ‰è”ç½‘ï¼Œä¸èƒ½æŸ¥è¯¢å¤©æ°”",
        "å†è§": "å†è§ï¼ç¥ä½ å­¦ä¹ æ„‰å¿«ï¼"
    }

    def simple_ai_chat(question):
        """
        ç®€å•çš„é—®ç­”AI

        å‚æ•°:
            question: ç”¨æˆ·çš„é—®é¢˜ï¼ˆå­—ç¬¦ä¸²ï¼‰

        è¿”å›:
            å›ç­”å­—ç¬¦ä¸²

        å·¥ä½œåŸç†:
            è¿™æ˜¯ä¸€ä¸ªåŸºäºè§„åˆ™çš„AIï¼Œå®ƒé€šè¿‡åŒ¹é…å…³é”®è¯æ¥å›ç­”é—®é¢˜ã€‚
            è™½ç„¶ç®€å•ï¼Œä½†å®ƒå±•ç¤ºäº†AIçš„æ ¸å¿ƒæ€æƒ³ï¼šè¾“å…¥â†’å¤„ç†â†’è¾“å‡º
        """
        question = question.lower()  # è½¬å°å†™
        for key, answer in qa_dict.items():
            if key in question:
                return answer
        return "è¿™ä¸ªé—®é¢˜æˆ‘è¿˜ä¸æ‡‚ï¼Œä½†æˆ‘æ­£åœ¨å­¦ä¹ ï¼"

    # æ¼”ç¤ºå¯¹è¯
    test_questions = ["ä½ å¥½å‘€", "ä»€ä¹ˆæ˜¯AIï¼Ÿ", "ä½ å‡ å²äº†", "å†è§"]
    for q in test_questions:
        print(f"  ğŸ‘¤ é—®ï¼š{q}")
        print(f"  ğŸ¤– ç­”ï¼š{simple_ai_chat(q)}")
        print()

    print("ğŸ’¡ å°çŸ¥è¯†ï¼šè¿™ä¸ªç®€å•çš„AIä½¿ç”¨'è§„åˆ™åŒ¹é…'æ–¹æ³•")
    print("   ç°ä»£AIä¼šä½¿ç”¨æ›´å¤æ‚çš„æ–¹æ³•ï¼Œæ¯”å¦‚æœºå™¨å­¦ä¹ ï¼")
    print()
    input("æŒ‰å›è½¦é”®ç»§ç»­ä¸‹ä¸€èŠ‚...")
    print()


# ============================================
# ç¬¬2èŠ‚ï¼šæœºå™¨å­¦ä¹ åŸºç¡€
# ============================================
def lesson_2_ml_basics():
    """
    ç¬¬2èŠ‚ï¼šæœºå™¨å­¦ä¹ åŸºç¡€
    ====================

    å­¦ä¹ ç›®æ ‡ï¼š
    - ç†è§£æœºå™¨å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µ
    - æŒæ¡è®­ç»ƒæ•°æ®ã€ç‰¹å¾ã€æ ‡ç­¾çš„å«ä¹‰
    - äº†è§£æœºå™¨å­¦ä¹ çš„å·¥ä½œæµç¨‹

    ã€ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿã€‘

    ä¼ ç»Ÿç¼–ç¨‹ï¼šäººç±»å†™è§„åˆ™ â†’ ç¨‹åºæ‰§è¡Œ
    æœºå™¨å­¦ä¹ ï¼šç»™ç¨‹åºæ•°æ® â†’ ç¨‹åºè‡ªå·±æ‰¾è§„å¾‹

    ä¾‹å­ï¼šè¯†åˆ«çŒ«å’Œç‹—
    - ä¼ ç»Ÿï¼šäººç±»æè¿°"çŒ«æœ‰å°–è€³æœµã€èƒ¡é¡»..."
    - æœºå™¨å­¦ä¹ ï¼šç»™ç¨‹åºçœ‹1000å¼ çŒ«å’Œç‹—çš„ç…§ç‰‡ï¼Œè®©å®ƒè‡ªå·±å­¦

    ã€æ ¸å¿ƒæ¦‚å¿µ - ç”¨å­¦ç”Ÿå­¦ä¹ æ¥æ¯”å–»ã€‘

    æƒ³è±¡ä¸€ä¸‹ï¼ŒAIå°±åƒä¸€ä¸ªå­¦ç”Ÿåœ¨å­¦ä¹ ï¼š

    1. è®­ç»ƒæ•°æ®ï¼ˆTraining Dataï¼‰
       - ç”¨æ¥æ•™AIçš„"æ•™æ"
       - å°±åƒå­¦ç”Ÿçš„è¯¾æœ¬å’Œç»ƒä¹ é¢˜

    2. ç‰¹å¾ï¼ˆFeaturesï¼‰
       - æè¿°äº‹ç‰©çš„å±æ€§ï¼Œç›¸å½“äº"é¢˜ç›®ä¸­çš„æ¡ä»¶"
       - æ¯”å¦‚ï¼šè‹¹æœçš„é¢œè‰²ã€å¤§å°ã€é‡é‡
       - å°±åƒæ•°å­¦é¢˜é‡Œçš„"å·²çŸ¥æ¡ä»¶"

    3. æ ‡ç­¾ï¼ˆLabelsï¼‰
       - æˆ‘ä»¬æƒ³é¢„æµ‹çš„ç»“æœï¼Œç›¸å½“äº"æ ‡å‡†ç­”æ¡ˆ"
       - æ¯”å¦‚ï¼šè‹¹æœçš„å“ç§ï¼ˆçº¢å¯Œå£«ã€é»„å…ƒå¸…...ï¼‰
       - æœ‰äº†æ ‡å‡†ç­”æ¡ˆï¼Œå­¦ç”Ÿæ‰èƒ½å¯¹ç…§å­¦ä¹ 

    4. æ¨¡å‹ï¼ˆModelï¼‰
       - AIå­¦åˆ°çš„"çŸ¥è¯†"å’Œè§£é¢˜æ–¹æ³•
       - å°±åƒå­¦ç”Ÿè®°ä½çš„è§„å¾‹å’Œè§£é¢˜æŠ€å·§
       - è®­ç»ƒåï¼Œæ¨¡å‹å°±èƒ½åƒå­¦ç”Ÿä¸€æ ·"åšé¢˜"äº†

    5. è®­ç»ƒï¼ˆTrainingï¼‰
       - è®©AIä»æ•°æ®ä¸­å­¦ä¹ çš„è¿‡ç¨‹
       - å°±åƒå­¦ç”Ÿåå¤åšç»ƒä¹ é¢˜ï¼Œæ€»ç»“è§„å¾‹
       - åœ¨ä»£ç é‡Œç”¨ fit() æ–¹æ³•è¡¨ç¤º

    ã€æœºå™¨å­¦ä¹ çš„æ­¥éª¤ã€‘

    1. æ”¶é›†æ•°æ®
    2. å‡†å¤‡ç‰¹å¾
    3. é€‰æ‹©ç®—æ³•
    4. è®­ç»ƒæ¨¡å‹
    5. è¯„ä¼°æ•ˆæœ
    6. ä½¿ç”¨æ¨¡å‹
    """
    print("=" * 60)
    print("ğŸ“š ç¬¬2èŠ‚ï¼šæœºå™¨å­¦ä¹ åŸºç¡€")
    print("=" * 60)
    print()

    print("ğŸ‰ è®©æˆ‘ä»¬ç”¨'æ°´æœåˆ†ç±»'æ¥ç†è§£æœºå™¨å­¦ä¹ ï¼")
    print()

    # åˆ›å»ºç®€å•çš„æ°´æœæ•°æ®
    print("ã€æ­¥éª¤1ï¼šæ”¶é›†æ•°æ®ã€‘")
    print("æˆ‘ä»¬æ”¶é›†äº†ä¸€äº›æ°´æœçš„æ•°æ®ï¼š")
    print()

    # ç‰¹å¾ï¼š[é‡é‡(å…‹), é¢œè‰²(1=çº¢è‰², 2=æ©™è‰², 3=é»„è‰²)]
    fruit_features = np.array([
        [150, 1],  # è‹¹æœ
        [160, 1],  # è‹¹æœ
        [140, 1],  # è‹¹æœ
        [200, 2],  # æ©™å­
        [180, 2],  # æ©™å­
        [190, 2],  # æ©™å­
        [120, 3],  # é¦™è•‰
        [110, 3],  # é¦™è•‰
        [130, 3],  # é¦™è•‰
    ])

    # æ ‡ç­¾ï¼š0=è‹¹æœ, 1=æ©™å­, 2=é¦™è•‰
    fruit_labels = np.array([0, 0, 0, 1, 1, 1, 2, 2, 2])
    fruit_names = ['è‹¹æœ', 'æ©™å­', 'é¦™è•‰']

    # æ˜¾ç¤ºæ•°æ®
    print("  é‡é‡(å…‹)  é¢œè‰²    æ°´æœç±»å‹")
    print("  --------  ----    --------")
    colors = {1: 'çº¢è‰²', 2: 'æ©™è‰²', 3: 'é»„è‰²'}
    for i in range(len(fruit_features)):
        weight, color = fruit_features[i]
        label = fruit_labels[i]
        print(f"    {weight:3d}     {colors[color]}      {fruit_names[label]}")

    print()
    print("ã€æ­¥éª¤2-4ï¼šè®­ç»ƒæ¨¡å‹ã€‘")
    print("æˆ‘ä»¬ä½¿ç”¨Kè¿‘é‚»ç®—æ³•ï¼ˆKNNï¼‰æ¥å­¦ä¹ è¿™äº›æ•°æ®")
    print()
    print("  KNNçš„åŸç†ï¼ˆç”¨å¤§ç™½è¯è¯´ï¼‰ï¼š")
    print("  æ‰¾æ–°æ°´æœçš„'é‚»å±…'ï¼Œçœ‹é‚»å±…ä»¬æ˜¯ä»€ä¹ˆï¼Œå°±åˆ¤æ–­å®ƒæ˜¯ä»€ä¹ˆ")
    print("  æ¯”å¦‚ï¼šæ–°æ°´æœå‘¨å›´3ä¸ªé‚»å±…éƒ½æ˜¯è‹¹æœï¼Œé‚£å®ƒå¾ˆå¯èƒ½ä¹Ÿæ˜¯è‹¹æœï¼")
    print("  è¿™å°±åƒ'ç‰©ä»¥ç±»èš'çš„é“ç†")
    print()

    # åˆ›å»ºKNNåˆ†ç±»å™¨
    # n_neighbors=3 è¡¨ç¤ºæ‰¾æœ€è¿‘çš„3ä¸ªé‚»å±…æ¥æŠ•ç¥¨å†³å®š
    knn = KNeighborsClassifier(n_neighbors=3)

    # fit æ˜¯"è®­ç»ƒ"çš„æ„æ€ï¼Œè®©æ¨¡å‹ä»æ•°æ®ä¸­å­¦ä¹ è§„å¾‹
    # å°±åƒè®©å­¦ç”Ÿçœ‹è¯¾æœ¬å­¦ä¹ ï¼Œfitä¹‹åæ¨¡å‹å°±"å­¦ä¼š"äº†
    knn.fit(fruit_features, fruit_labels)
    print("âœ… æ¨¡å‹è®­ç»ƒå®Œæˆï¼")

    print()
    print("ã€æ­¥éª¤5-6ï¼šä½¿ç”¨æ¨¡å‹ã€‘")
    print("ç°åœ¨è®©æˆ‘ä»¬é¢„æµ‹ä¸€äº›æ–°æ°´æœï¼š")
    print()

    # é¢„æµ‹æ–°æ•°æ®
    new_fruits = np.array([
        [155, 1],  # åº”è¯¥æ˜¯è‹¹æœ
        [185, 2],  # åº”è¯¥æ˜¯æ©™å­
        [125, 3],  # åº”è¯¥æ˜¯é¦™è•‰
    ])

    predictions = knn.predict(new_fruits)

    for i, (features, pred) in enumerate(zip(new_fruits, predictions)):
        weight, color = features
        print(f"  æ–°æ°´æœ {i+1}: {weight}å…‹, {colors[color]} â†’ é¢„æµ‹ä¸ºï¼š{fruit_names[pred]}")

    print()
    print("ğŸ’¡ æ€»ç»“ï¼š")
    print("   - ç‰¹å¾ï¼šé‡é‡ã€é¢œè‰²ï¼ˆæè¿°æ°´æœçš„å±æ€§ï¼Œå°±åƒé¢˜ç›®çš„æ¡ä»¶ï¼‰")
    print("   - æ ‡ç­¾ï¼šæ°´æœç±»å‹ï¼ˆæˆ‘ä»¬è¦é¢„æµ‹çš„ç­”æ¡ˆï¼‰")
    print("   - æ¨¡å‹ï¼šå­¦ä¼šäº†æ ¹æ®ç‰¹å¾åˆ¤æ–­æ°´æœç±»å‹")
    print("   - fit()ï¼šè®©æ¨¡å‹å­¦ä¹ çš„æ–¹æ³•ï¼Œå°±åƒè®©å­¦ç”Ÿçœ‹ä¹¦å­¦ä¹ ")
    print("   - predict()ï¼šè®©æ¨¡å‹é¢„æµ‹çš„æ–¹æ³•ï¼Œå°±åƒè®©å­¦ç”Ÿåšé¢˜")
    print()
    input("æŒ‰å›è½¦é”®ç»§ç»­ä¸‹ä¸€èŠ‚...")
    print()


# ============================================
# ç¬¬3èŠ‚ï¼šsklearnå…¥é—¨
# ============================================
def lesson_3_sklearn_intro():
    """
    ç¬¬3èŠ‚ï¼šsklearn å…¥é—¨
    ====================

    å­¦ä¹ ç›®æ ‡ï¼š
    - äº†è§£sklearnåº“çš„ä½œç”¨
    - å­¦ä¼šä½¿ç”¨å†…ç½®æ•°æ®é›†
    - æŒæ¡æ•°æ®çš„åŸºæœ¬æ“ä½œ

    ã€ä»€ä¹ˆæ˜¯sklearnï¼Ÿã€‘

    sklearnï¼ˆscikit-learnï¼‰æ˜¯Pythonæœ€æµè¡Œçš„æœºå™¨å­¦ä¹ åº“
    å°±åƒä¸€ä¸ª"AIå·¥å…·ç®±"ï¼Œé‡Œé¢æœ‰å¾ˆå¤šç°æˆçš„å·¥å…·ï¼š
    - å„ç§ç®—æ³•ï¼ˆåˆ†ç±»ã€å›å½’ã€èšç±»...ï¼‰
    - ç¤ºä¾‹æ•°æ®é›†
    - æ•°æ®å¤„ç†å·¥å…·
    - æ¨¡å‹è¯„ä¼°æ–¹æ³•

    ã€sklearnå†…ç½®æ•°æ®é›†ã€‘

    sklearnæä¾›äº†ä¸€äº›ç»å…¸æ•°æ®é›†ï¼Œæ–¹ä¾¿å­¦ä¹ ï¼š
    1. irisï¼ˆé¸¢å°¾èŠ±ï¼‰ï¼šåˆ†ç±»é—®é¢˜ç»å…¸æ•°æ®ï¼Œæœ‰150æœµèŠ±çš„æµ‹é‡æ•°æ®
    2. californiaï¼ˆåŠ å·æˆ¿ä»·ï¼‰ï¼šå›å½’é—®é¢˜æ•°æ®ï¼Œé¢„æµ‹æˆ¿ä»·
    3. digitsï¼ˆæ‰‹å†™æ•°å­—ï¼‰ï¼šå›¾åƒè¯†åˆ«æ•°æ®ï¼Œ0-9çš„æ‰‹å†™æ•°å­—å›¾ç‰‡
    4. wineï¼ˆè‘¡è„é…’ï¼‰ï¼šæ ¹æ®æˆåˆ†åˆ†ç±»è‘¡è„é…’ç§ç±»

    ã€é‡è¦æç¤ºï¼šæ•°æ®æ ¼å¼ã€‘

    sklearnçš„æ•°æ®é›†é€šå¸¸åŒ…å«ï¼š
    - dataï¼šç‰¹å¾æ•°æ®ï¼ˆä¸€ä¸ªäºŒç»´è¡¨æ ¼ï¼Œæ¯è¡Œä¸€ä¸ªæ ·æœ¬ï¼Œæ¯åˆ—ä¸€ä¸ªç‰¹å¾ï¼‰
    - targetï¼šæ ‡ç­¾æ•°æ®ï¼ˆæ¯ä¸ªæ ·æœ¬å¯¹åº”çš„ç­”æ¡ˆï¼‰
    - feature_namesï¼šç‰¹å¾åç§°ï¼ˆæ¯åˆ—å«ä»€ä¹ˆåå­—ï¼‰
    - target_namesï¼šæ ‡ç­¾åç§°ï¼ˆç­”æ¡ˆåˆ†åˆ«ä»£è¡¨ä»€ä¹ˆï¼‰
    - DESCRï¼šæ•°æ®é›†çš„è¯¦ç»†è¯´æ˜ï¼ˆDESCRæ˜¯descriptionçš„ç¼©å†™ï¼‰
    """
    print("=" * 60)
    print("ğŸ“š ç¬¬3èŠ‚ï¼šsklearnå…¥é—¨")
    print("=" * 60)
    print()

    print("ğŸŒº è®©æˆ‘ä»¬æ¥çœ‹çœ‹sklearnçš„é¸¢å°¾èŠ±æ•°æ®é›†ï¼")
    print()

    # åŠ è½½é¸¢å°¾èŠ±æ•°æ®é›†ï¼ˆsklearnå†…ç½®ï¼Œä¸éœ€è¦ä¸‹è½½ï¼‰
    iris = datasets.load_iris()

    print("ã€æ•°æ®é›†ä»‹ç»ã€‘")
    # DESCR æ˜¯æ•°æ®é›†çš„è¯´æ˜æ–‡æ¡£ï¼Œè¿™é‡Œåªå–ç¬¬ä¸€è¡Œä½œä¸ºåç§°
    first_line = iris.DESCR.split('\n')[0]
    print(f"  æ•°æ®é›†åç§°ï¼š{first_line}")
    print(f"  æ ·æœ¬æ•°é‡ï¼š{len(iris.data)} æœµèŠ±")
    print(f"  ç‰¹å¾æ•°é‡ï¼š{len(iris.feature_names)} ä¸ª")
    print(f"  ç‰¹å¾åç§°ï¼š{iris.feature_names}")
    print(f"  ç±»åˆ«æ•°é‡ï¼š{len(iris.target_names)} ç§")
    print(f"  ç±»åˆ«åç§°ï¼š{list(iris.target_names)}")
    print()

    # è½¬æ¢ä¸ºDataFrameæ–¹ä¾¿æŸ¥çœ‹
    # DataFrameå°±åƒExcelè¡¨æ ¼ï¼Œæœ‰è¡Œæœ‰åˆ—ï¼Œæ˜¯pandasåº“çš„æ ¸å¿ƒæ•°æ®ç»“æ„
    df = pd.DataFrame(iris.data, columns=iris.feature_names)
    df['target'] = iris.target  # æ·»åŠ æ ‡ç­¾åˆ—
    df['target_name'] = [iris.target_names[t] for t in iris.target]  # æ·»åŠ æ ‡ç­¾åç§°åˆ—

    print("ã€å‰10æ¡æ•°æ®é¢„è§ˆã€‘")
    print(df.head(10).to_string())
    print()

    print("ã€æ•°æ®ç»Ÿè®¡ã€‘")
    print(df.describe().to_string())
    print()

    # å¯è§†åŒ–
    print("ğŸ“Š æ­£åœ¨ç”Ÿæˆæ•°æ®å¯è§†åŒ–å›¾è¡¨...")

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # å›¾1ï¼šèŠ±ç“£é•¿åº¦ vs èŠ±ç“£å®½åº¦
    colors = ['red', 'green', 'blue']
    for i, name in enumerate(iris.target_names):
        mask = df['target'] == i
        axes[0].scatter(
            df.loc[mask, 'petal length (cm)'],
            df.loc[mask, 'petal width (cm)'],
            c=colors[i],
            label=name,
            alpha=0.7
        )
    axes[0].set_xlabel('èŠ±ç“£é•¿åº¦ (cm)')
    axes[0].set_ylabel('èŠ±ç“£å®½åº¦ (cm)')
    axes[0].set_title('é¸¢å°¾èŠ±æ•°æ®é›† - èŠ±ç“£ç‰¹å¾åˆ†å¸ƒ')
    axes[0].legend()

    # å›¾2ï¼šå„ç±»åˆ«æ•°é‡
    df['target_name'].value_counts().plot(kind='bar', ax=axes[1], color=['red', 'green', 'blue'])
    axes[1].set_xlabel('å“ç§')
    axes[1].set_ylabel('æ•°é‡')
    axes[1].set_title('å„ç±»åˆ«æ ·æœ¬æ•°é‡')
    axes[1].tick_params(axis='x', rotation=0)

    plt.tight_layout()
    plt.savefig('/mnt/c/dev/python/qqstudy/ai_intro/iris_visualization.png', dpi=100)
    print("âœ… å›¾è¡¨å·²ä¿å­˜åˆ°ï¼širis_visualization.png")
    plt.close()

    print()
    print("ğŸ’¡ å°çŸ¥è¯†ï¼š")
    print("   - è¿™å°±æ˜¯æœºå™¨å­¦ä¹ ä¸­å¸¸ç”¨çš„æ•°æ®æ ¼å¼")
    print("   - æ¯è¡Œæ˜¯ä¸€ä¸ªæ ·æœ¬ï¼ˆä¸€æœµèŠ±ï¼‰")
    print("   - æ¯åˆ—æ˜¯ä¸€ä¸ªç‰¹å¾ï¼ˆèŠ±çš„å±æ€§ï¼‰")
    print("   - DataFrameå°±åƒExcelè¡¨æ ¼ï¼Œpandasæ˜¯ç”¨æ¥å¤„ç†è¡¨æ ¼æ•°æ®çš„å·¥å…·")
    print()
    input("æŒ‰å›è½¦é”®ç»§ç»­ä¸‹ä¸€èŠ‚...")
    print()


# ============================================
# ç¬¬4èŠ‚ï¼šåˆ†ç±»é—®é¢˜ - é¸¢å°¾èŠ±
# ============================================
def lesson_4_classification():
    """
    ç¬¬4èŠ‚ï¼šåˆ†ç±»é—®é¢˜ - é¸¢å°¾èŠ±åˆ†ç±»
    =============================

    å­¦ä¹ ç›®æ ‡ï¼š
    - ç†è§£ä»€ä¹ˆæ˜¯åˆ†ç±»é—®é¢˜
    - å­¦ä¼šè®­ç»ƒåˆ†ç±»æ¨¡å‹
    - æŒæ¡æ¨¡å‹çš„ä½¿ç”¨æ–¹æ³•

    ã€ä»€ä¹ˆæ˜¯åˆ†ç±»ï¼Ÿã€‘

    åˆ†ç±» = æŠŠäº‹ç‰©åˆ†åˆ°ä¸åŒçš„ç±»åˆ«

    ä¾‹å­ï¼š
    - é‚®ä»¶ï¼šåƒåœ¾é‚®ä»¶ / æ­£å¸¸é‚®ä»¶
    - å›¾ç‰‡ï¼šçŒ« / ç‹— / é¸Ÿ
    - æ°´æœï¼šè‹¹æœ / æ©™å­ / é¦™è•‰

    ã€åˆ†ç±»çš„æ­¥éª¤ã€‘
    1. å‡†å¤‡æ•°æ®ï¼ˆå¸¦æœ‰æ ‡ç­¾çš„è®­ç»ƒæ•°æ®ï¼‰
    2. åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†
    3. é€‰æ‹©ç®—æ³•å¹¶è®­ç»ƒ
    4. é¢„æµ‹å¹¶è¯„ä¼°
    """
    print("=" * 60)
    print("ğŸ“š ç¬¬4èŠ‚ï¼šåˆ†ç±»é—®é¢˜ - é¸¢å°¾èŠ±åˆ†ç±»")
    print("=" * 60)
    print()

    print("ğŸŒº é¸¢å°¾èŠ±åˆ†ç±»ä»»åŠ¡")
    print("ç›®æ ‡ï¼šæ ¹æ®èŠ±çš„ç‰¹å¾ï¼Œé¢„æµ‹å®ƒæ˜¯å“ªç§é¸¢å°¾èŠ±")
    print()

    # åŠ è½½æ•°æ®
    iris = datasets.load_iris()
    X = iris.data   # ç‰¹å¾ï¼ˆèŠ±è¼é•¿åº¦ã€èŠ±è¼å®½åº¦ã€èŠ±ç“£é•¿åº¦ã€èŠ±ç“£å®½åº¦ï¼‰
    y = iris.target # æ ‡ç­¾ï¼ˆèŠ±çš„å“ç§ï¼‰

    print("ã€æ­¥éª¤1ï¼šåˆ’åˆ†æ•°æ®é›†ã€‘")
    print("  è®­ç»ƒé›†ï¼šç”¨æ¥æ•™AIå­¦ä¹ ï¼ˆ70%ï¼‰")
    print("  æµ‹è¯•é›†ï¼šç”¨æ¥è€ƒè¯•ï¼Œæ£€éªŒå­¦ä¹ æ•ˆæœï¼ˆ30%ï¼‰")
    print()
    print("  ä¸ºä»€ä¹ˆè¦åˆ†å¼€ï¼Ÿ")
    print("  å¦‚æœç”¨åŒä¸€ä»½æ•°æ®å­¦ä¹ å’Œè€ƒè¯•ï¼Œå°±åƒåšç»ƒä¹ é¢˜æ—¶å·²ç»çœ‹è¿‡ç­”æ¡ˆï¼Œ")
    print("  è¿™æ ·æ— æ³•æ£€éªŒçœŸå®æ°´å¹³ã€‚æ‰€ä»¥è¦ç”¨ä¸åŒçš„æ•°æ®æ¥æµ‹è¯•ï¼")
    print()

    # åˆ’åˆ†æ•°æ®é›†
    # X_train, X_testï¼šè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„ç‰¹å¾
    # y_train, y_testï¼šè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æ ‡ç­¾
    # test_size=0.3ï¼šæµ‹è¯•é›†å 30%
    # random_state=42ï¼šéšæœºç§å­ï¼Œä¿è¯æ¯æ¬¡è¿è¡Œç»“æœä¸€æ ·ï¼ˆ42æ˜¯ä¸€ä¸ªå¸¸ç”¨ä¹ æƒ¯ï¼Œå¯ä»¥æ˜¯ä»»æ„æ•°å­—ï¼‰
    X_train, X_test, y_train, y_test = train_test_split(
        X, y, test_size=0.3, random_state=42
    )

    print(f"  è®­ç»ƒé›†å¤§å°ï¼š{len(X_train)} ä¸ªæ ·æœ¬")
    print(f"  æµ‹è¯•é›†å¤§å°ï¼š{len(X_test)} ä¸ªæ ·æœ¬")
    print()

    print("ã€æ­¥éª¤2ï¼šé€‰æ‹©ç®—æ³•å¹¶è®­ç»ƒã€‘")
    print("  æˆ‘ä»¬ä½¿ç”¨Kè¿‘é‚»ç®—æ³•ï¼ˆKNNï¼‰")
    print("  åŸç†ï¼šæ‰¾æœ€è¿‘çš„Kä¸ªé‚»å±…ï¼Œçœ‹å®ƒä»¬å±äºå“ªä¸€ç±»")
    print("  è¿™å°±åƒåˆ¤æ–­ä¸€ä¸ªæ–°åŒå­¦æ¥è‡ªå“ªé‡Œï¼Œçœ‹ä»–å‘¨å›´çš„æœ‹å‹éƒ½æ˜¯å“ªé‡Œçš„")
    print()

    # åˆ›å»ºKNNåˆ†ç±»å™¨
    # n_neighbors=5 è¡¨ç¤ºçœ‹æœ€è¿‘çš„5ä¸ªé‚»å±…
    knn = KNeighborsClassifier(n_neighbors=5)
    # fitï¼šè®­ç»ƒæ¨¡å‹ï¼Œè®©æ¨¡å‹"å­¦ä¼š"ä»ç‰¹å¾é¢„æµ‹æ ‡ç­¾
    knn.fit(X_train, y_train)
    print("  âœ… è®­ç»ƒå®Œæˆï¼")

    print()
    print("ã€æ­¥éª¤3ï¼šé¢„æµ‹æµ‹è¯•é›†ã€‘")
    # predictï¼šç”¨è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹
    # y_pred æ˜¯æ¨¡å‹é¢„æµ‹çš„ç­”æ¡ˆ
    y_pred = knn.predict(X_test)

    # æ˜¾ç¤ºéƒ¨åˆ†é¢„æµ‹ç»“æœ
    print("  å®é™…å€¼ vs é¢„æµ‹å€¼ï¼š")
    print("  --------- ---------")
    for i in range(min(10, len(y_test))):
        actual = iris.target_names[y_test[i]]
        predicted = iris.target_names[y_pred[i]]
        match = "âœ“" if y_test[i] == y_pred[i] else "âœ—"
        print(f"  {actual:15s} {predicted:15s} {match}")

    print()
    print("ã€æ­¥éª¤4ï¼šè¯„ä¼°æ¨¡å‹ã€‘")
    # accuracy_scoreï¼šè®¡ç®—å‡†ç¡®ç‡ï¼Œå°±æ˜¯ç­”å¯¹çš„æ¯”ä¾‹
    accuracy = accuracy_score(y_test, y_pred)
    print(f"  å‡†ç¡®ç‡ï¼š{accuracy:.2%}")
    print(f"  ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¨¡å‹ç­”å¯¹äº† {int(accuracy * len(y_test))} / {len(y_test)} é¢˜")
    print()

    print("ã€æ­¥éª¤5ï¼šé¢„æµ‹æ–°æ•°æ®ã€‘")
    print("  å‡è®¾æˆ‘ä»¬åœ¨é‡å¤–å‘ç°ä¸€æœµé¸¢å°¾èŠ±ï¼š")
    print("  èŠ±è¼é•¿åº¦=5.1cm, èŠ±è¼å®½åº¦=3.5cm, èŠ±ç“£é•¿åº¦=1.4cm, èŠ±ç“£å®½åº¦=0.2cm")

    # æ³¨æ„ï¼šæ–°æ•°æ®è¦ç”¨äºŒç»´æ•°ç»„ï¼Œå³ä½¿æ˜¯å•ä¸ªæ ·æœ¬ä¹Ÿè¦ç”¨ [[]]
    # å› ä¸ºæ¨¡å‹æœŸæœ›çš„è¾“å…¥æ ¼å¼æ˜¯"å¤šä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬å¤šä¸ªç‰¹å¾"
    new_flower = np.array([[5.1, 3.5, 1.4, 0.2]])
    prediction = knn.predict(new_flower)
    print(f"  ğŸŒ¸ é¢„æµ‹ç»“æœï¼š{iris.target_names[prediction[0]]}")
    print()

    print("ğŸ’¡ æ€»ç»“ï¼š")
    print("   åˆ†ç±»å°±æ˜¯ç»™äº‹ç‰©è´´æ ‡ç­¾")
    print("   æ¨¡å‹é€šè¿‡å­¦ä¹ å·²çŸ¥æ ‡ç­¾çš„æ•°æ®ï¼Œæ¥é¢„æµ‹æ–°æ•°æ®çš„æ ‡ç­¾")
    print()
    print("   å¸¸ç”¨æ–¹æ³•å›é¡¾ï¼š")
    print("   - fit(X, y)ï¼šè®­ç»ƒæ¨¡å‹ï¼ŒXæ˜¯ç‰¹å¾ï¼Œyæ˜¯æ ‡ç­¾")
    print("   - predict(X)ï¼šé¢„æµ‹æ–°æ•°æ®çš„æ ‡ç­¾")
    print("   - accuracy_scoreï¼šè®¡ç®—å‡†ç¡®ç‡")
    print()
    input("æŒ‰å›è½¦é”®ç»§ç»­ä¸‹ä¸€èŠ‚...")
    print()


# ============================================
# ç¬¬5èŠ‚ï¼šå›å½’é—®é¢˜ - æˆ¿ä»·é¢„æµ‹
# ============================================
def lesson_5_regression():
    """
    ç¬¬5èŠ‚ï¼šå›å½’é—®é¢˜ - æˆ¿ä»·é¢„æµ‹
    ===========================

    å­¦ä¹ ç›®æ ‡ï¼š
    - ç†è§£ä»€ä¹ˆæ˜¯å›å½’é—®é¢˜
    - å­¦ä¼šä½¿ç”¨çº¿æ€§å›å½’
    - æŒæ¡å›å½’æ¨¡å‹çš„è¯„ä¼°

    ã€ä»€ä¹ˆæ˜¯å›å½’ï¼Ÿã€‘

    ä¸Šä¸€èŠ‚æˆ‘ä»¬å­¦äº†"åˆ†ç±»"ï¼Œåˆ†ç±»çš„ç»“æœæ˜¯ç±»åˆ«ï¼ˆå¦‚ï¼šçŒ«ã€ç‹—ã€é¸Ÿï¼‰
    è¿™ä¸€èŠ‚æˆ‘ä»¬å­¦"å›å½’"ï¼Œå›å½’çš„ç»“æœæ˜¯ä¸€ä¸ªå…·ä½“çš„æ•°å­—

    å›å½’ = é¢„æµ‹ä¸€ä¸ªè¿ç»­çš„æ•°å€¼

    ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š
    - æˆ¿ä»·é¢„æµ‹ï¼šæ ¹æ®é¢ç§¯ã€ä½ç½®é¢„æµ‹ä»·æ ¼ï¼ˆå¦‚ï¼š200ä¸‡ã€350ä¸‡ï¼‰
    - æ°”æ¸©é¢„æµ‹ï¼šæ ¹æ®æ—¥æœŸé¢„æµ‹æ¸©åº¦ï¼ˆå¦‚ï¼š25åº¦ã€30åº¦ï¼‰
    - èº«é«˜é¢„æµ‹ï¼šæ ¹æ®çˆ¶æ¯èº«é«˜é¢„æµ‹å­©å­èº«é«˜ï¼ˆå¦‚ï¼š175cmï¼‰

    ã€å›å½’ vs åˆ†ç±» - ä¸€å¥è¯åŒºåˆ†ã€‘

    åˆ†ç±»ï¼šç­”æ¡ˆæ˜¯"æ˜¯ä»€ä¹ˆ"ï¼ˆçŒ«è¿˜æ˜¯ç‹—ï¼Ÿï¼‰
    å›å½’ï¼šç­”æ¡ˆæ˜¯"å¤šå°‘"ï¼ˆä»·æ ¼æ˜¯å¤šå°‘ï¼Ÿï¼‰

    ã€çº¿æ€§å›å½’ - æœ€ç®€å•çš„å›å½’æ–¹æ³•ã€‘

    æƒ³è±¡ä½ åœ¨çº¸ä¸Šç”»äº†å¾ˆå¤šç‚¹ï¼Œç„¶åç”¨å°ºå­ç”»ä¸€æ¡ç›´çº¿ç©¿è¿‡å®ƒä»¬
    è®©è¿™æ¡ç›´çº¿å°½å¯èƒ½é è¿‘æ‰€æœ‰çš„ç‚¹ï¼Œè¿™å°±æ˜¯çº¿æ€§å›å½’ï¼

    ç›´çº¿æ–¹ç¨‹ï¼šy = kx + bï¼ˆæˆ–è€…å†™æˆ y = wx + bï¼‰
    - wï¼ˆæˆ–kï¼‰æ˜¯æ–œç‡ï¼šxæ¯å¢åŠ 1ï¼Œyå¢åŠ å¤šå°‘
    - bæ˜¯æˆªè·ï¼šç›´çº¿å’Œyè½´çš„äº¤ç‚¹
    """
    print("=" * 60)
    print("ğŸ“š ç¬¬5èŠ‚ï¼šå›å½’é—®é¢˜ - æˆ¿ä»·é¢„æµ‹")
    print("=" * 60)
    print()

    print("ğŸ  æˆ¿ä»·é¢„æµ‹ä»»åŠ¡")
    print("ç›®æ ‡ï¼šæ ¹æ®æˆ¿å±‹ç‰¹å¾ï¼Œé¢„æµ‹æˆ¿ä»·")
    print()

    # ä½¿ç”¨sklearnçš„æ³¢å£«é¡¿æˆ¿ä»·æ•°æ®æ›¿ä»£ï¼ˆåŠ å·æˆ¿ä»·ï¼‰
    from sklearn.datasets import fetch_california_housing

    print("ã€åŠ è½½æ•°æ®ã€‘")
    california = fetch_california_housing()
    X = california.data
    y = california.target

    print(f"  æ•°æ®é›†ï¼šåŠ å·æˆ¿ä»·")
    print(f"  æ ·æœ¬æ•°é‡ï¼š{len(X)} ä¸ªæˆ¿å±‹")
    print(f"  ç‰¹å¾æ•°é‡ï¼š{X.shape[1]} ä¸ª")
    print(f"  ç‰¹å¾åç§°ï¼š{california.feature_names}")
    print()

    # è½¬æ¢ä¸ºDataFrame
    df = pd.DataFrame(X, columns=california.feature_names)
    df['price'] = y

    print("ã€æ•°æ®é¢„è§ˆã€‘")
    print(df.head().to_string())
    print()

    # ç®€åŒ–ï¼šåªç”¨ä¸€ä¸ªç‰¹å¾ï¼ˆæ”¶å…¥ä¸­ä½æ•°ï¼‰
    print("ã€ç®€åŒ–é—®é¢˜ã€‘")
    print("  ä¸ºäº†æ–¹ä¾¿ç†è§£å’Œå¯è§†åŒ–ï¼Œæˆ‘ä»¬åªç”¨'æ”¶å…¥ä¸­ä½æ•°'è¿™ä¸€ä¸ªç‰¹å¾æ¥é¢„æµ‹æˆ¿ä»·")
    print("  å®é™…åº”ç”¨ä¸­ä¼šä½¿ç”¨æ›´å¤šç‰¹å¾ï¼Œæ•ˆæœä¼šæ›´å¥½")
    print()

    # ä½¿ç”¨å•ä¸ªç‰¹å¾
    # X[:, [0]] è¡¨ç¤ºå–æ‰€æœ‰è¡Œçš„ç¬¬0åˆ—ï¼ˆæ”¶å…¥ä¸­ä½æ•°ï¼‰
    # ç”¨ [0] è€Œä¸æ˜¯ 0ï¼Œæ˜¯ä¸ºäº†ä¿æŒäºŒç»´æ•°ç»„æ ¼å¼
    X_rooms = X[:, [0]]  # MedIncï¼ˆæ”¶å…¥ä¸­ä½æ•°ï¼‰

    # åˆ’åˆ†æ•°æ®
    X_train, X_test, y_train, y_test = train_test_split(
        X_rooms, y, test_size=0.3, random_state=42
    )

    print(f"  è®­ç»ƒé›†ï¼š{len(X_train)} ä¸ªæ ·æœ¬")
    print(f"  æµ‹è¯•é›†ï¼š{len(X_test)} ä¸ªæ ·æœ¬")
    print()

    print("ã€è®­ç»ƒçº¿æ€§å›å½’æ¨¡å‹ã€‘")
    # LinearRegression æ˜¯çº¿æ€§å›å½’æ¨¡å‹ï¼Œç”¨æ¥æ‰¾æœ€ä½³æ‹Ÿåˆç›´çº¿
    model = LinearRegression()
    # fitï¼šè®­ç»ƒæ¨¡å‹ï¼Œæ‰¾åˆ°æœ€ä½³çš„ wï¼ˆæ–œç‡ï¼‰å’Œ bï¼ˆæˆªè·ï¼‰
    model.fit(X_train, y_train)
    print("  âœ… è®­ç»ƒå®Œæˆï¼")
    print()
    # model.coef_ æ˜¯å­¦åˆ°çš„æ–œç‡ï¼ˆç³»æ•°ï¼‰
    # model.intercept_ æ˜¯å­¦åˆ°çš„æˆªè·
    print(f"  å­¦åˆ°çš„ç›´çº¿æ–¹ç¨‹ï¼šæˆ¿ä»· = {model.coef_[0]:.2f} Ã— æ”¶å…¥ + {model.intercept_:.2f}")
    print(f"  æ„æ€æ˜¯ï¼šæ”¶å…¥æ¯å¢åŠ 1ï¼Œæˆ¿ä»·å¤§çº¦å¢åŠ  {model.coef_[0]:.2f}")
    print()

    # é¢„æµ‹ï¼šç”¨è®­ç»ƒå¥½çš„æ¨¡å‹é¢„æµ‹æµ‹è¯•é›†çš„æˆ¿ä»·
    y_pred = model.predict(X_test)

    # è¯„ä¼°
    # MSEï¼ˆå‡æ–¹è¯¯å·®ï¼‰ï¼šé¢„æµ‹å€¼å’ŒçœŸå®å€¼å·®çš„å¹³æ–¹çš„å¹³å‡ï¼Œè¶Šå°è¶Šå¥½
    mse = mean_squared_error(y_test, y_pred)
    # RÂ²ï¼ˆå†³å®šç³»æ•°ï¼‰ï¼šæ¨¡å‹è§£é‡Šæ•°æ®å˜åŒ–çš„æ¯”ä¾‹ï¼Œè¶Šæ¥è¿‘1è¶Šå¥½
    # RÂ²=1è¡¨ç¤ºå®Œç¾é¢„æµ‹ï¼ŒRÂ²=0è¡¨ç¤ºæ¨¡å‹æ¯«æ— ç”¨å¤„
    r2 = r2_score(y_test, y_pred)

    print("ã€æ¨¡å‹è¯„ä¼°ã€‘")
    print(f"  å‡æ–¹è¯¯å·®(MSE)ï¼š{mse:.4f}")
    print("    è§£é‡Šï¼šé¢„æµ‹å€¼å’ŒçœŸå®å€¼å·®å¼‚çš„å¹³æ–¹å¹³å‡ï¼Œè¶Šå°è¶Šå¥½")
    print(f"  RÂ²åˆ†æ•°ï¼š{r2:.4f}")
    print("    è§£é‡Šï¼šRÂ²è¶Šæ¥è¿‘1ï¼Œæ¨¡å‹è¶Šå¥½ï¼›å¦‚æœæ˜¯0.5ï¼Œè¯´æ˜æ¨¡å‹è§£é‡Šäº†50%çš„å˜åŒ–")
    print()

    # å¯è§†åŒ–
    print("ğŸ“Š æ­£åœ¨ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨...")

    plt.figure(figsize=(10, 6))  # åˆ›å»º10x6è‹±å¯¸çš„ç”»å¸ƒ
    # ç”»æ•£ç‚¹å›¾ï¼šåªå–å‰500ä¸ªç‚¹ï¼Œé¿å…å›¾å¤ªå¯†é›†
    # alpha=0.5 è¡¨ç¤ºåŠé€æ˜ï¼Œs=10 è¡¨ç¤ºç‚¹çš„å¤§å°
    plt.scatter(X_test[:500], y_test[:500], alpha=0.5, label='å®é™…æ•°æ®', s=10)
    # ç”»é¢„æµ‹ç›´çº¿ï¼ˆæ³¨æ„ï¼šå› ä¸ºæ˜¯ç›´çº¿ï¼Œæ‰€ä»¥ä¼šæ˜¯ä¸€æ¡æ–œçº¿ï¼‰
    plt.plot(X_test[:500], y_pred[:500], 'r-', label='é¢„æµ‹ç›´çº¿', linewidth=2)
    plt.xlabel('æ”¶å…¥ä¸­ä½æ•°')
    plt.ylabel('æˆ¿ä»·ï¼ˆå•ä½ï¼š10ä¸‡ç¾å…ƒï¼‰')
    plt.title('çº¿æ€§å›å½’ï¼šæ”¶å…¥ vs æˆ¿ä»·')
    plt.legend()
    plt.savefig('/mnt/c/dev/python/qqstudy/ai_intro/regression_plot.png', dpi=100)
    print("âœ… å›¾è¡¨å·²ä¿å­˜åˆ°ï¼šregression_plot.png")
    plt.close()

    print()
    print("ã€é¢„æµ‹æ–°æ•°æ®ã€‘")
    new_income = np.array([[5.0]])  # æ”¶å…¥ä¸­ä½æ•°ä¸º5
    predicted_price = model.predict(new_income)
    print(f"  å¦‚æœæŸåœ°åŒºæ”¶å…¥ä¸­ä½æ•°ä¸º5ï¼Œé¢„æµ‹æˆ¿ä»·ä¸ºï¼š{predicted_price[0]:.2f} * 10ä¸‡ = {predicted_price[0]*10:.1f}ä¸‡ç¾å…ƒ")
    print()

    print("ğŸ’¡ æ€»ç»“ï¼š")
    print("   å›å½’ç”¨äºé¢„æµ‹è¿ç»­æ•°å€¼")
    print("   çº¿æ€§å›å½’æ‰¾ä¸€æ¡æœ€åˆé€‚çš„ç›´çº¿æ¥æ‹Ÿåˆæ•°æ®")
    print()
    input("æŒ‰å›è½¦é”®ç»§ç»­ä¸‹ä¸€èŠ‚...")
    print()


# ============================================
# ç¬¬6èŠ‚ï¼šæ¨¡å‹è¯„ä¼°
# ============================================
def lesson_6_evaluation():
    """
    ç¬¬6èŠ‚ï¼šæ¨¡å‹è¯„ä¼°
    =================

    å­¦ä¹ ç›®æ ‡ï¼š
    - ç†è§£æ¨¡å‹è¯„ä¼°çš„é‡è¦æ€§
    - æŒæ¡å¸¸ç”¨è¯„ä¼°æŒ‡æ ‡
    - å­¦ä¼šåˆ¤æ–­æ¨¡å‹å¥½å

    ã€ä¸ºä»€ä¹ˆéœ€è¦è¯„ä¼°ï¼Ÿã€‘

    å°±åƒå­¦ç”Ÿéœ€è¦è€ƒè¯•ï¼Œæ¨¡å‹ä¹Ÿéœ€è¦è¯„ä¼°
    - æ£€éªŒå­¦ä¹ æ•ˆæœ
    - å‘ç°é—®é¢˜
    - æ¯”è¾ƒä¸åŒæ¨¡å‹

    ã€å¸¸ç”¨è¯„ä¼°æŒ‡æ ‡ - ç”¨è€ƒè¯•æ¥æ¯”å–»ã€‘

    åˆ†ç±»é—®é¢˜ï¼ˆåƒåˆ¤æ–­é¢˜ã€é€‰æ‹©é¢˜ï¼‰ï¼š
    - å‡†ç¡®ç‡(Accuracy)ï¼šç­”å¯¹çš„æ¯”ä¾‹
      ä¾‹ï¼š10é“é¢˜å¯¹8é“ï¼Œå‡†ç¡®ç‡80%

    - ç²¾ç¡®ç‡(Precision)ï¼šä½ è¯´æ˜¯å¯¹çš„é¢˜é‡Œé¢ï¼ŒçœŸæ­£å¯¹çš„æ¯”ä¾‹
      ä¾‹ï¼šä½ é€‰äº†5é“"å¯¹"ï¼Œä½†åªæœ‰4é“çœŸçš„å¯¹ï¼Œç²¾ç¡®ç‡4/5=80%

    - å¬å›ç‡(Recall)ï¼šæ‰€æœ‰çœŸæ­£å¯¹çš„é¢˜ï¼Œä½ æ‰¾å‡ºäº†å¤šå°‘
      ä¾‹ï¼šæœ‰6é“é¢˜åº”è¯¥é€‰"å¯¹"ï¼Œä½ åªæ‰¾å‡ºäº†4é“ï¼Œå¬å›ç‡4/6=67%

    å›å½’é—®é¢˜ï¼ˆåƒä¼°ç®—é¢˜ï¼‰ï¼š
    - å‡æ–¹è¯¯å·®(MSE)ï¼šé¢„æµ‹å€¼å’ŒçœŸå®å€¼å·®çš„å¹³æ–¹å¹³å‡
      ä¾‹ï¼šé¢„æµ‹æˆ¿ä»·200ä¸‡ï¼Œå®é™…180ä¸‡ï¼Œå·®20ä¸‡ï¼Œå¹³æ–¹å°±æ˜¯400

    - RÂ²åˆ†æ•°ï¼šæ¨¡å‹è§£é‡Šäº†å¤šå°‘æ•°æ®å˜åŒ–ï¼ˆè¶Šæ¥è¿‘1è¶Šå¥½ï¼‰
      å¯ä»¥ç†è§£ä¸º"æ¨¡å‹æœ‰å¤šå‰å®³"ï¼Œ1æ˜¯æ»¡åˆ†ï¼Œ0æ˜¯ä¸åŠæ ¼
    """
    print("=" * 60)
    print("ğŸ“š ç¬¬6èŠ‚ï¼šæ¨¡å‹è¯„ä¼°")
    print("=" * 60)
    print()

    print("ğŸ“Š è®©æˆ‘ä»¬å­¦ä¹ å¦‚ä½•è¯„ä¼°æ¨¡å‹çš„å¥½å")
    print()

    # åˆ†ç±»è¯„ä¼°ç¤ºä¾‹
    print("ã€åˆ†ç±»é—®é¢˜è¯„ä¼°ã€‘")
    print()

    iris = datasets.load_iris()
    X_train, X_test, y_train, y_test = train_test_split(
        iris.data, iris.target, test_size=0.3, random_state=42
    )

    # è®­ç»ƒæ¨¡å‹
    knn = KNeighborsClassifier(n_neighbors=5)
    knn.fit(X_train, y_train)
    y_pred = knn.predict(X_test)

    # è®¡ç®—å„ç§æŒ‡æ ‡
    from sklearn.metrics import precision_score, recall_score, f1_score, classification_report

    accuracy = accuracy_score(y_test, y_pred)

    print("  å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰ï¼š")
    print(f"    {accuracy:.2%}")
    print("    è§£é‡Šï¼šé¢„æµ‹æ­£ç¡®çš„æ¯”ä¾‹")
    print()

    print("  è¯¦ç»†åˆ†ç±»æŠ¥å‘Šï¼ˆåŒ…å«ç²¾ç¡®ç‡ã€å¬å›ç‡ç­‰ï¼‰ï¼š")
    # classification_report ä¼šè¾“å‡ºè¯¦ç»†çš„åˆ†ç±»è¯„ä¼°æŠ¥å‘Š
    print(classification_report(y_test, y_pred, target_names=iris.target_names))

    # å›å½’è¯„ä¼°ç¤ºä¾‹
    print()
    print("ã€å›å½’é—®é¢˜è¯„ä¼°ã€‘")
    print()

    from sklearn.datasets import fetch_california_housing
    california = fetch_california_housing()
    X_train, X_test, y_train, y_test = train_test_split(
        california.data, california.target, test_size=0.3, random_state=42
    )

    model = LinearRegression()
    model.fit(X_train, y_train)
    y_pred = model.predict(X_test)

    mse = mean_squared_error(y_test, y_pred)
    rmse = np.sqrt(mse)  # np.sqrt æ˜¯å¼€å¹³æ–¹æ ¹çš„å‡½æ•°
    r2 = r2_score(y_test, y_pred)

    print(f"  å‡æ–¹è¯¯å·®(MSE)ï¼š{mse:.4f}")
    print("    è§£é‡Šï¼šé¢„æµ‹å€¼ä¸çœŸå®å€¼å·®å¼‚çš„å¹³æ–¹å¹³å‡ï¼Œè¶Šå°è¶Šå¥½")
    print()
    print(f"  å‡æ–¹æ ¹è¯¯å·®(RMSE)ï¼š{rmse:.4f}")
    print("    è§£é‡Šï¼šMSEçš„å¼€å¹³æ–¹æ ¹ï¼Œå•ä½ä¸åŸæ•°æ®ç›¸åŒï¼Œæ›´å®¹æ˜“ç†è§£")
    print(f"    æ¯”å¦‚ï¼šè¿™é‡Œçš„RMSE={rmse:.2f}ï¼Œæ„å‘³ç€å¹³å‡è¯¯å·®çº¦{rmse:.2f}*10ä¸‡ç¾å…ƒ")
    print()
    print(f"  RÂ²åˆ†æ•°ï¼š{r2:.4f}")
    print("    è§£é‡Šï¼šæ¨¡å‹è§£é‡Šæ•°æ®å˜åŒ–çš„æ¯”ä¾‹ï¼Œè¶Šæ¥è¿‘1è¶Šå¥½")
    print(f"    è¿™é‡Œçš„RÂ²={r2:.2f}ï¼Œè¯´æ˜æ¨¡å‹è§£é‡Šäº†{r2*100:.1f}%çš„æ•°æ®å˜åŒ–")
    print()

    # è¿‡æ‹Ÿåˆä¸æ¬ æ‹Ÿåˆ
    print("ã€é‡è¦æ¦‚å¿µï¼šè¿‡æ‹Ÿåˆä¸æ¬ æ‹Ÿåˆ - ç”¨å­¦ä¹ æ¥æ¯”å–»ã€‘")
    print()
    print("  æ¬ æ‹Ÿåˆ(Underfitting)ï¼š")
    print("    æ¨¡å‹å¤ªç®€å•ï¼Œå­¦å¾—ä¸å¤Ÿ")
    print("    å°±åƒåªèƒŒäº†å‡ ä¸ªå•è¯å°±å»è€ƒè‹±è¯­ï¼Œè®­ç»ƒé›†å’Œæµ‹è¯•é›†éƒ½ä¸åŠæ ¼")
    print()
    print("  è¿‡æ‹Ÿåˆ(Overfitting)ï¼š")
    print("    æ¨¡å‹å¤ªå¤æ‚ï¼Œæ­»è®°ç¡¬èƒŒ")
    print("    å°±åƒæŠŠè¯¾æœ¬èƒŒä¸‹æ¥ï¼Œç»ƒä¹ é¢˜å…¨å¯¹ï¼Œä½†è€ƒè¯•é¢˜ä¸€å˜å°±ä¸ä¼šäº†")
    print("    è¡¨ç°ï¼šè®­ç»ƒé›†å‡†ç¡®ç‡å¾ˆé«˜ï¼Œæµ‹è¯•é›†å¾ˆä½")
    print()
    print("  å¥½çš„æ¨¡å‹ï¼š")
    print("    æ—¢ä¸å¤ªç®€å•ä¹Ÿä¸å¤ªå¤æ‚ï¼Œèƒ½å¤Ÿä¸¾ä¸€åä¸‰")
    print("    è¡¨ç°ï¼šè®­ç»ƒé›†å’Œæµ‹è¯•é›†éƒ½è¡¨ç°è‰¯å¥½ï¼Œå·®è·ä¸å¤§")
    print()

    print("ğŸ’¡ æ€»ç»“ï¼š")
    print("   è¯„ä¼°æ˜¯æ£€éªŒæ¨¡å‹æ•ˆæœçš„å…³é”®æ­¥éª¤")
    print("   ä¸åŒé—®é¢˜ä½¿ç”¨ä¸åŒçš„è¯„ä¼°æŒ‡æ ‡")
    print()
    input("æŒ‰å›è½¦é”®ç»§ç»­ä¸‹ä¸€èŠ‚...")
    print()


# ============================================
# ç¬¬7èŠ‚ï¼šæƒ…æ„Ÿåˆ†æ
# ============================================
def lesson_7_sentiment():
    """
    ç¬¬7èŠ‚ï¼šæƒ…æ„Ÿåˆ†æ - NLPå…¥é—¨
    ==========================

    å­¦ä¹ ç›®æ ‡ï¼š
    - ç†è§£è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰
    - å­¦ä¼šç®€å•çš„æ–‡æœ¬åˆ†ç±»
    - å®ç°æƒ…æ„Ÿåˆ†æ

    ã€ä»€ä¹ˆæ˜¯NLPï¼Ÿã€‘

    NLP = Natural Language Processingï¼ˆè‡ªç„¶è¯­è¨€å¤„ç†ï¼‰
    è®©è®¡ç®—æœºèƒ½å¤Ÿ"è¯»æ‡‚"äººç±»è¯­è¨€

    ç”Ÿæ´»ä¸­çš„åº”ç”¨ï¼š
    - æœºå™¨ç¿»è¯‘ï¼ˆGoogleç¿»è¯‘ã€ç™¾åº¦ç¿»è¯‘ï¼‰
    - æ™ºèƒ½å®¢æœï¼ˆè‡ªåŠ¨å›ç­”é—®é¢˜ï¼‰
    - æƒ…æ„Ÿåˆ†æï¼ˆåˆ¤æ–­è¯„è®ºæ˜¯å¥½è¯„è¿˜æ˜¯å·®è¯„ï¼‰
    - è¯­éŸ³åŠ©æ‰‹ï¼ˆSiriã€å°çˆ±åŒå­¦ï¼‰

    ã€æƒ…æ„Ÿåˆ†æã€‘

    åˆ¤æ–­ä¸€æ®µæ–‡å­—çš„æƒ…æ„Ÿå€¾å‘ï¼š
    - æ­£é¢ï¼ˆå¥½è¯„ï¼‰ï¼šå¼€å¿ƒã€æ»¡æ„ã€å–œæ¬¢ã€èµ...
    - è´Ÿé¢ï¼ˆå·®è¯„ï¼‰ï¼šéš¾è¿‡ã€å¤±æœ›ã€è®¨åŒã€å·®...
    """
    print("=" * 60)
    print("ğŸ“š ç¬¬7èŠ‚ï¼šæƒ…æ„Ÿåˆ†æ - NLPå…¥é—¨")
    print("=" * 60)
    print()

    print("ğŸ˜Š è®©æˆ‘ä»¬å­¦ä¹ å¦‚ä½•åˆ†ææ–‡å­—çš„æƒ…æ„Ÿï¼")
    print()

    # ç®€å•çš„æƒ…æ„Ÿè¯å…¸æ–¹æ³•
    print("ã€æ–¹æ³•1ï¼šæƒ…æ„Ÿè¯å…¸æ³• - æœ€ç®€å•çš„æ–¹æ³•ã€‘")
    print("  åŸç†ï¼šå‡†å¤‡å¥½ã€Œå¥½è¯è¡¨ã€å’Œã€Œåè¯è¡¨ã€ï¼Œæ•°æ•°å“ªä¸ªå¤š")
    print()

    # å®šä¹‰ç®€å•çš„æƒ…æ„Ÿè¯å…¸
    # å°±åƒå‡†å¤‡ä¸¤ä»½åå•ï¼šä¸€ä»½æ˜¯"å¥½è¯"ï¼Œä¸€ä»½æ˜¯"åè¯"
    positive_words = ['å¥½', 'æ£’', 'å–œæ¬¢', 'å¼€å¿ƒ', 'é«˜å…´', 'ä¼˜ç§€', 'ç¾ä¸½', 'å¯çˆ±', 'å®Œç¾', 'èµ']
    negative_words = ['å·®', 'çƒ‚', 'è®¨åŒ', 'éš¾è¿‡', 'ä¼¤å¿ƒ', 'ç³Ÿç³•', 'ä¸‘é™‹', 'æ— èŠ', 'å¤±è´¥', 'åƒåœ¾']

    def simple_sentiment(text):
        """
        ç®€å•çš„æƒ…æ„Ÿåˆ†æå‡½æ•°

        å‚æ•°:
            text: è¦åˆ†æçš„æ–‡æœ¬ï¼ˆå­—ç¬¦ä¸²ï¼‰

        è¿”å›:
            æƒ…æ„Ÿç±»åˆ«å’Œå¾—åˆ†ï¼ˆå…ƒç»„ï¼‰

        å·¥ä½œåŸç†:
            ç»Ÿè®¡æ–‡æœ¬ä¸­æ­£é¢è¯å’Œè´Ÿé¢è¯çš„æ•°é‡
            æ ¹æ®å·®å€¼åˆ¤æ–­æƒ…æ„Ÿå€¾å‘
        """
        # ç»Ÿè®¡æ­£é¢è¯å‡ºç°çš„æ¬¡æ•°
        # è¿™è¡Œä»£ç çš„æ„æ€æ˜¯ï¼šéå†æ‰€æœ‰æ­£é¢è¯ï¼Œå¦‚æœåœ¨textä¸­æ‰¾åˆ°ï¼Œå°±+1
        positive_count = sum(1 for word in positive_words if word in text)
        # ç»Ÿè®¡è´Ÿé¢è¯å‡ºç°çš„æ¬¡æ•°
        negative_count = sum(1 for word in negative_words if word in text)

        # è®¡ç®—å¾—åˆ†ï¼šæ­£é¢è¯æ•° - è´Ÿé¢è¯æ•°
        score = positive_count - negative_count

        # æ ¹æ®å¾—åˆ†åˆ¤æ–­æƒ…æ„Ÿ
        if score > 0:  # æ­£é¢è¯æ›´å¤š
            return 'æ­£é¢', score
        elif score < 0:  # è´Ÿé¢è¯æ›´å¤š
            return 'è´Ÿé¢', score
        else:  # ä¸€æ ·å¤šï¼Œæˆ–è€…éƒ½æ²¡æœ‰
            return 'ä¸­æ€§', score

    # æµ‹è¯•
    test_texts = [
        "è¿™å®¶é¤å…çš„èœå¾ˆå¥½åƒï¼ŒæœåŠ¡ä¹Ÿå¾ˆæ£’ï¼",
        "è¿™ç”µå½±å¤ªçƒ‚äº†ï¼Œç®€ç›´æ˜¯æµªè´¹æ—¶é—´",
        "ä»Šå¤©å¤©æ°”ä¸é”™ï¼Œå¿ƒæƒ…ä¹Ÿå¾ˆå¥½",
        "è¿™äº§å“å¤ªå·®äº†ï¼Œæˆ‘å¾ˆå¤±æœ›",
        "æ™®é€šçš„ä¸€å¤©ï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«çš„"
    ]

    print("  æµ‹è¯•æƒ…æ„Ÿåˆ†æï¼š")
    for text in test_texts:
        sentiment, score = simple_sentiment(text)
        print(f"    '{text[:20]}...' â†’ {sentiment} (å¾—åˆ†: {score})")
    print()

    # æœºå™¨å­¦ä¹ æ–¹æ³•
    print("ã€æ–¹æ³•2ï¼šæœºå™¨å­¦ä¹ æ³• - æ›´æ™ºèƒ½çš„æ–¹æ³•ã€‘")
    print("  åŸç†ï¼šè®©AIè‡ªå·±ä»ä¾‹å­ä¸­å­¦ä¹ ï¼Œè€Œä¸æ˜¯äººå·¥å®šä¹‰è¯å…¸")
    print()

    from sklearn.feature_extraction.text import CountVectorizer
    from sklearn.naive_bayes import MultinomialNB

    # è®­ç»ƒæ•°æ®ï¼š8æ¡æ­£é¢è¯„è®º + 8æ¡è´Ÿé¢è¯„è®º
    # å°±åƒç»™å­¦ç”Ÿçœ‹ä¾‹å¥ï¼Œå‘Šè¯‰ä»–ä»¬å“ªäº›æ˜¯å¥½çš„ï¼Œå“ªäº›æ˜¯åçš„
    train_texts = [
        "æˆ‘å¾ˆå¼€å¿ƒ", "ä»Šå¤©çœŸé«˜å…´", "å¤ªæ£’äº†", "éå¸¸å–œæ¬¢",
        "è´¨é‡å¾ˆå¥½", "æœåŠ¡ä¼˜ç§€", "å®Œç¾ä½“éªŒ", "éå¸¸æ»¡æ„",
        "æˆ‘å¾ˆä¼¤å¿ƒ", "å¤ªè®¨åŒäº†", "çœŸç³Ÿç³•", "éå¸¸å¤±æœ›",
        "è´¨é‡å¾ˆå·®", "æœåŠ¡æ¶åŠ£", "ç³Ÿç³•ä½“éªŒ", "éå¸¸ä¸æ»¡"
    ]

    # æ ‡ç­¾ï¼š1è¡¨ç¤ºæ­£é¢ï¼Œ0è¡¨ç¤ºè´Ÿé¢
    train_labels = [1, 1, 1, 1, 1, 1, 1, 1,  # å‰8æ¡æ˜¯æ­£é¢
                    0, 0, 0, 0, 0, 0, 0, 0]  # å8æ¡æ˜¯è´Ÿé¢

    # ã€å…³é”®æ­¥éª¤ã€‘æŠŠæ–‡å­—è½¬æˆæ•°å­—ï¼ˆè®¡ç®—æœºåªè®¤è¯†æ•°å­—ï¼ï¼‰
    # è¯è¢‹æ¨¡å‹ï¼ˆBag of Wordsï¼‰ï¼šç»Ÿè®¡æ¯ä¸ªè¯å‡ºç°çš„æ¬¡æ•°
    # æ¯”å¦‚å¥å­"æˆ‘å¾ˆå¼€å¿ƒ"å˜æˆï¼š[æˆ‘:1, å¾ˆ:1, å¼€å¿ƒ:1, ...]
    vectorizer = CountVectorizer()  # åˆ›å»ºä¸€ä¸ª"æ–‡å­—è½¬æ•°å­—"çš„å·¥å…·
    X_train = vectorizer.fit_transform(train_texts)  # è½¬æ¢è®­ç»ƒæ•°æ®
    # X_train ç°åœ¨æ˜¯ä¸€ä¸ªæ•°å­—çŸ©é˜µï¼Œæ¯è¡Œä»£è¡¨ä¸€å¥è¯çš„"æ•°å­—ç‰ˆ"

    # è®­ç»ƒæœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨
    # æœ´ç´ è´å¶æ–¯æ˜¯ä¸€ç§ç®€å•ä½†å¾ˆæœ‰æ•ˆçš„åˆ†ç±»ç®—æ³•
    # å®ƒçš„åå­—æ¥æºäºè´å¶æ–¯å®šç†ï¼ˆä¸€ç§æ¦‚ç‡è®¡ç®—æ–¹æ³•ï¼‰
    clf = MultinomialNB()  # åˆ›å»ºåˆ†ç±»å™¨
    clf.fit(X_train, train_labels)  # è®­ç»ƒ
    print("  âœ… æ¨¡å‹è®­ç»ƒå®Œæˆï¼")
    print()

    # æµ‹è¯•
    test_texts = ["éå¸¸å¼€å¿ƒ", "å¤ªå·®äº†", "å¾ˆæ»¡æ„", "å¾ˆè®¨åŒ"]
    # æ³¨æ„ï¼šæµ‹è¯•æ•°æ®åªç”¨ transformï¼Œä¸ç”¨ fit_transform
    # å› ä¸ºæˆ‘ä»¬è¦ç”¨è®­ç»ƒæ—¶å­¦åˆ°çš„"è¯å…¸"ï¼Œä¸èƒ½é‡æ–°å­¦
    X_test = vectorizer.transform(test_texts)
    predictions = clf.predict(X_test)

    print("  é¢„æµ‹ç»“æœï¼š")
    for text, pred in zip(test_texts, predictions):
        label = "æ­£é¢" if pred == 1 else "è´Ÿé¢"
        print(f"    '{text}' â†’ {label}")
    print()

    print("ğŸ’¡ æ€»ç»“ï¼š")
    print("   NLPè®©è®¡ç®—æœºèƒ½ç†è§£äººç±»è¯­è¨€")
    print("   æƒ…æ„Ÿåˆ†æå¯ä»¥åˆ¤æ–­æ–‡å­—çš„æƒ…ç»ªå€¾å‘")
    print("   ä¸¤ç§æ–¹æ³•ï¼š")
    print("     - è¯å…¸æ³•ï¼šç®€å•ç›´æ¥ï¼Œä½†éœ€è¦äººå·¥æ•´ç†è¯å…¸")
    print("     - æœºå™¨å­¦ä¹ æ³•ï¼šè‡ªåŠ¨å­¦ä¹ ï¼Œä½†éœ€è¦æ ‡æ³¨æ•°æ®")
    print()
    input("æŒ‰å›è½¦é”®ç»§ç»­ä¸‹ä¸€èŠ‚...")
    print()


# ============================================
# ç¬¬8èŠ‚ï¼šAIçš„æœªæ¥å’Œä¼¦ç†
# ============================================
def lesson_8_future_ethics():
    """
    ç¬¬8èŠ‚ï¼šAIçš„æœªæ¥å’Œä¼¦ç†
    ======================

    å­¦ä¹ ç›®æ ‡ï¼š
    - äº†è§£AIçš„å‘å±•è¶‹åŠ¿
    - ç†è§£AIä¼¦ç†é—®é¢˜
    - åŸ¹å…»æ­£ç¡®çš„AIè§‚å¿µ

    ã€AIçš„æœªæ¥ã€‘

    1. æ›´å¼ºå¤§çš„AI
       - GPTã€å¤§è¯­è¨€æ¨¡å‹
       - å¤šæ¨¡æ€AIï¼ˆæ–‡å­—ã€å›¾åƒã€å£°éŸ³ï¼‰

    2. AIæ— å¤„ä¸åœ¨
       - è‡ªåŠ¨é©¾é©¶
       - æ™ºèƒ½å®¶å±…
       - åŒ»ç–—è¯Šæ–­

    3. AIåˆ›é€ 
       - AIç»˜ç”»
       - AIä½œæ›²
       - AIå†™ä½œ

    ã€AIä¼¦ç†ã€‘

    1. å…¬å¹³æ€§
       - AIä¼šæœ‰åè§å—ï¼Ÿ
       - å¦‚ä½•ç¡®ä¿å…¬å¹³ï¼Ÿ

    2. éšç§
       - AIéœ€è¦æ•°æ®ï¼Œä½†æ•°æ®ä»å“ªæ¥ï¼Ÿ
       - æˆ‘ä»¬çš„æ•°æ®å®‰å…¨å—ï¼Ÿ

    3. å°±ä¸š
       - AIä¼šå–ä»£äººç±»å·¥ä½œå—ï¼Ÿ
       - æˆ‘ä»¬åº”è¯¥å­¦ä¹ ä»€ä¹ˆï¼Ÿ

    4. è´£ä»»
       - AIçŠ¯é”™ï¼Œè°æ¥è´Ÿè´£ï¼Ÿ
       - å¦‚ä½•ç›‘ç®¡AIï¼Ÿ
    """
    print("=" * 60)
    print("ğŸ“š ç¬¬8èŠ‚ï¼šAIçš„æœªæ¥å’Œä¼¦ç†")
    print("=" * 60)
    print()

    print("ğŸ”® è®©æˆ‘ä»¬æ¥æ€è€ƒAIçš„æœªæ¥å’Œä¼¦ç†é—®é¢˜")
    print()

    print("ã€AIçš„æœªæ¥å‘å±•è¶‹åŠ¿ã€‘")
    print()
    print("  1. å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰")
    print("     - åƒGPTè¿™æ ·çš„AIèƒ½ç†è§£å’Œç”Ÿæˆäººç±»è¯­è¨€")
    print("     - å¯ä»¥å¯¹è¯ã€å†™ä½œã€ç¼–ç¨‹...")
    print()
    print("  2. å¤šæ¨¡æ€AI")
    print("     - èƒ½åŒæ—¶ç†è§£æ–‡å­—ã€å›¾ç‰‡ã€å£°éŸ³ã€è§†é¢‘")
    print("     - åƒäººç±»ä¸€æ ·ï¼Œç”¨å¤šç§æ–¹å¼æ„ŸçŸ¥ä¸–ç•Œ")
    print()
    print("  3. é€šç”¨äººå·¥æ™ºèƒ½ï¼ˆAGIï¼‰")
    print("     - åƒäººç±»ä¸€æ ·æ€è€ƒå’Œå­¦ä¹ çš„AI")
    print("     - ç›®å‰è¿˜åœ¨ç ”ç©¶ä¸­")
    print()

    print("ã€AIä¼¦ç†é—®é¢˜æ€è€ƒã€‘")
    print()

    # äº’åŠ¨æ€è€ƒé—®é¢˜
    questions = [
        {
            "q": "å¦‚æœAIèƒ½å¸®ä½ å†™ä½œä¸šï¼Œä½ è¿˜ä¼šè‡ªå·±å­¦å—ï¼Ÿ",
            "thought": "å­¦ä¹ ä¸åªæ˜¯ä¸ºäº†ç­”æ¡ˆï¼Œæ›´æ˜¯ä¸ºäº†åŸ¹å…»æ€ç»´èƒ½åŠ›"
        },
        {
            "q": "AIç”¨äººè„¸è¯†åˆ«æŠ“åäººï¼Œä½†ä¹Ÿå¯èƒ½ç›‘è§†æ™®é€šäººï¼Œè¿™å¥½å—ï¼Ÿ",
            "thought": "å®‰å…¨ä¸éšç§ä¹‹é—´éœ€è¦å¹³è¡¡"
        },
        {
            "q": "è‡ªåŠ¨é©¾é©¶æ±½è½¦å‡ºäº†äº‹æ•…ï¼Œåº”è¯¥ç”±è°è´Ÿè´£ï¼Ÿ",
            "thought": "AIçš„è´£ä»»å½’å±æ˜¯ä¸€ä¸ªå¤æ‚çš„é—®é¢˜"
        },
        {
            "q": "AIå¯ä»¥åˆ›ä½œè‰ºæœ¯å“ï¼Œè¿™ç®—è‰ºæœ¯å—ï¼Ÿ",
            "thought": "è‰ºæœ¯çš„å®šä¹‰å¯èƒ½éœ€è¦é‡æ–°æ€è€ƒ"
        }
    ]

    for i, item in enumerate(questions, 1):
        print(f"  æ€è€ƒ{i}ï¼š{item['q']}")
        print(f"    â†’ {item['thought']}")
        print()

    print("ã€å¦‚ä½•æ­£ç¡®çœ‹å¾…AIã€‘")
    print()
    print("  âœ… AIæ˜¯å·¥å…·ï¼Œä¸æ˜¯ç¥")
    print("  âœ… AIå¯ä»¥å¸®åŠ©äººç±»ï¼Œä½†ä¸èƒ½å®Œå…¨æ›¿ä»£äººç±»")
    print("  âœ… å­¦ä¹ AIçŸ¥è¯†ï¼Œæ›´å¥½åœ°ä½¿ç”¨AI")
    print("  âœ… ä¿æŒæ€è€ƒï¼Œä¸è¦ç›²ç›®ç›¸ä¿¡AI")
    print("  âœ… å…³æ³¨ä¼¦ç†ï¼Œè´Ÿè´£ä»»åœ°å‘å±•AI")
    print()

    print("ã€å­¦ä¹ å»ºè®®ã€‘")
    print()
    print("  1. æ‰“å¥½æ•°å­¦åŸºç¡€ï¼ˆä»£æ•°ã€æ¦‚ç‡ã€ç»Ÿè®¡ï¼‰")
    print("  2. å­¦å¥½ç¼–ç¨‹ï¼ˆPythonæ˜¯AIä¸»æµè¯­è¨€ï¼‰")
    print("  3. å¤šåŠ¨æ‰‹å®è·µï¼Œåšé¡¹ç›®")
    print("  4. å…³æ³¨AIæ–°é—»å’Œå‘å±•")
    print("  5. åŸ¹å…»æ‰¹åˆ¤æ€§æ€ç»´")
    print()

    print("=" * 60)
    print("ğŸ‰ æ­å–œä½ å®Œæˆäº†AIå…¥é—¨é€Ÿæˆæ•™ç¨‹ï¼")
    print("=" * 60)
    print()
    print("  ä½ å·²ç»å­¦ä¼šäº†ï¼š")
    print("  âœ“ ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½")
    print("  âœ“ æœºå™¨å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µ")
    print("  âœ“ ä½¿ç”¨sklearnè¿›è¡Œåˆ†ç±»å’Œå›å½’")
    print("  âœ“ æ¨¡å‹è¯„ä¼°æ–¹æ³•")
    print("  âœ“ ç®€å•çš„æƒ…æ„Ÿåˆ†æ")
    print("  âœ“ AIä¼¦ç†æ€è€ƒ")
    print()
    print("  æ¥ä¸‹æ¥å¯ä»¥ï¼š")
    print("  1. å®Œæˆ ai_exercises.py ä¸­çš„ç»ƒä¹ é¢˜")
    print("  2. è¿è¡Œ projects/ æ–‡ä»¶å¤¹ä¸­çš„é¡¹ç›®")
    print("  3. ç»§ç»­æ·±å…¥å­¦ä¹ æœºå™¨å­¦ä¹ ç®—æ³•")
    print()
    print("  åŠ æ²¹ï¼Œæœªæ¥çš„AIå·¥ç¨‹å¸ˆï¼ğŸš€")
    print()


# ============================================
# ä¸»ç¨‹åº
# ============================================
def main():
    """
    ä¸»ç¨‹åºå…¥å£

    è¿è¡Œæ‰€æœ‰æ•™ç¨‹ç« èŠ‚
    """
    print("\n" + "ğŸ¯ AIå…¥é—¨é€Ÿæˆæ•™ç¨‹ - å¼€å§‹å­¦ä¹ ï¼" + "\n")

    # è¿è¡Œæ‰€æœ‰ç« èŠ‚
    lesson_1_what_is_ai()
    lesson_2_ml_basics()
    lesson_3_sklearn_intro()
    lesson_4_classification()
    lesson_5_regression()
    lesson_6_evaluation()
    lesson_7_sentiment()
    lesson_8_future_ethics()


if __name__ == "__main__":
    main()
